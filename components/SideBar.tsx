'use client';

import Link from "next/link";
import Image from "next/image";
import {useEffect, useState} from "react";
import {googleLogout} from "@/lib/GoogleSession";

interface SidebarProps {
    propFunction?: (value: (((prevState: string) => string) | string)) => void
}

function SideBar({propFunction}: SidebarProps) {
    const [selectedMenu, setSelectedMenu] = useState<string>('dashboard');

    const clickMenu = (menu: string) => {
        setSelectedMenu(menu);
        propFunction && propFunction(menu);
        console.log("clickMenu", selectedMenu);
    }


    useEffect(() => {
        const toggleBtn = document.querySelector('.lnb-toggle-btn');
        if (toggleBtn) {
            toggleBtn.addEventListener('click', function () {
                // Toggle LNB size (240px <-> 82px)
                const lnb = document.getElementById('lnb');
                if (lnb) {
                    lnb.classList.toggle('lnb-collapsed');

                    // Update search wrapper classes based on LNB state
                    const searchWrapper = lnb.querySelector('.search-wrapper');
                    if (searchWrapper) {
                        const isCollapsed = lnb.classList.contains('lnb-collapsed');

                        if (isCollapsed) {
                            // Collapsed mode: switch to shorten mode
                            searchWrapper.classList.remove('search-expand-default', 'search-expand-typing', 'search-expand-done');
                            searchWrapper.classList.add('search-shorten-default');

                        } else {
                            // Expanded mode: switch to expand mode
                            searchWrapper.classList.remove('search-shorten-default', 'search-shorten-hover');
                            searchWrapper.classList.add('search-expand-default');

                        }
                    }
                }
            });
        }

    }, []);

    return (
            <>
            <div id="lnb-container">
                <aside className="lnb" id="lnb" data-name="Property 1=LNB 240" data-node-id="179:7127">

                    <div className="lnb-content" data-name="Content">

                        <div className="lnb-logo" data-name="Top">
                            <Image src="/images/BI_GENA.png" alt="G-AIOps Logo" className="lnb-logo-full" width={200}
                                   height={50}/>
                            <Image src="/images/BI_GENA_2.png" alt="G-AIOps Logo" className="lnb-logo-compact" width={42}
                                   height={42}/>
                        </div>

                        <nav className="lnb-menu" data-name="list">
                            <a href="#dashboards"
                               className={`lnb-menu-item ${selectedMenu == 'dashboard' ? 'lnb-menu-item-active' : ''}`}
                               data-node-id="244:10706" onClick={() => clickMenu('dashboard')}>
                                <span className="lnb-menu-icon" data-name="Dashboards-01">
                                    <svg width="20" height="21">
                                        <use href="#icon-dashboards"></use>
                                    </svg>
                                </span>
                                <span className="lnb-menu-text">Dashboards</span>
                            </a>

                            <a href="#jupyter-settings"
                               className={`lnb-menu-item ${selectedMenu == 'setting' ? 'lnb-menu-item-active' : ''}`}
                               data-node-id="244:11275" onClick={() => clickMenu('setting')}>
                                <span className="lnb-menu-icon" data-name="Jupyter-01">
                                    <svg width="20" height="21">
                                        <use href="#icon-jupyter-settings"></use>
                                    </svg>
                                </span>
                                <span className="lnb-menu-text">Jupyter 설정</span>
                            </a>

                            <a href="#jupyter-run" className="lnb-menu-item" data-node-id="244:11654">
                        <span className="lnb-menu-icon" data-name="Jupyter-02">
                            <svg width="20" height="21">
                                <use href="#icon-jupyter-run"></use>
                            </svg>
                        </span>
                                <span className="lnb-menu-text">Jupyter 실행</span>
                            </a>
                        </nav>

                        <div className="lnb-search hide" data-name="search" data-node-id="179:6125">
                            <div className="search-wrapper search-expand-default" data-name="input" data-node-id="179:6126">
                                <input
                                    type="text"
                                    className="search-field"
                                    placeholder="Search"
                                />
                                <span className="search-icon" data-name="search-01" data-node-id="179:6927">
                                    <svg width="20" height="20">
                                        <use href="#icon-search"></use>
                                    </svg>
                                </span>
                            </div>

                            <div className="lnb-divider" data-name="Divider" data-node-id="513:23071">
                                <div className="lnb-divider-line"></div>
                            </div>

                            <button className="lnb-toggle-btn" data-name="icon_L_close" data-node-id="508:22018"
                                    title="Toggle LNB Size">
                                <svg width="20" height="20" className="lnb-toggle-icon">
                                    <use href="#icon-toggle-close"></use>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div className="lnb-bottom" data-name="bottom">
                        <div className="lnb-bottom-menu" data-name="list">
                            <a href="#settings" className="lnb-bottom-item"
                               onClick={() => googleLogout()}>
                                <span className="lnb-bottom-icon">
                                    <svg width="20" height="20">
                                        <use href="#icon-settings"></use>
                                    </svg>
                                </span>
                                <span className="lnb-bottom-text">Logout</span>
                            </a>
                            <a href="#help" className="lnb-bottom-item hide">
                                <span className="lnb-bottom-icon">
                                    <svg width="20" height="20">
                                        <use href="#icon-help"></use>
                                    </svg>
                                </span>
                                <span className="lnb-bottom-text">Help</span>
                            </a>
                        </div>
                    </div>

                </aside>
            </div>
            <svg className="hide" xmlns="http://www.w3.org/2000/svg">
                <symbol id="icon-dashboards" viewBox="0 0 20 21">
                    <path
                        d="M7.6053 6.96166C8.06554 6.96166 8.43863 6.58857 8.43863 6.12833C8.43863 5.66809 8.06554 5.295 7.6053 5.295V6.12833V6.96166ZM3.01915 5.295C2.55891 5.295 2.18581 5.66809 2.18581 6.12833C2.18581 6.58857 2.55891 6.96166 3.01915 6.96166V6.12833V5.295ZM17 6.96166C17.4602 6.96166 17.8333 6.58857 17.8333 6.12833C17.8333 5.66809 17.4602 5.295 17 5.295V6.12833V6.96166ZM12.1915 5.295C11.7312 5.295 11.3581 5.66809 11.3581 6.12833C11.3581 6.58857 11.7312 6.96166 12.1915 6.96166V6.12833V5.295ZM8.76343 4.59961V5.43294H11.0256V4.59961V3.76628H8.76343V4.59961ZM11.7796 5.35366H10.9463V7.61581H11.7796H12.613V5.35366H11.7796ZM11.0256 8.36986V7.53653H8.76343V8.36986V9.20319H11.0256V8.36986ZM8.00938 7.61581H8.84271V5.35366H8.00938H7.17604V7.61581H8.00938ZM8.76343 8.36986V7.53653C8.80721 7.53653 8.84271 7.57202 8.84271 7.61581H8.00938H7.17604C7.17604 8.4925 7.88674 9.20319 8.76343 9.20319V8.36986ZM11.7796 7.61581H10.9463C10.9463 7.57203 10.9818 7.53653 11.0256 7.53653V8.36986V9.20319C11.9023 9.20319 12.613 8.4925 12.613 7.61581H11.7796ZM11.0256 4.59961V5.43294C10.9818 5.43294 10.9463 5.39744 10.9463 5.35366H11.7796H12.613C12.613 4.47697 11.9023 3.76628 11.0256 3.76628V4.59961ZM8.76343 4.59961V3.76628C7.88674 3.76628 7.17604 4.47697 7.17604 5.35366H8.00938H8.84271C8.84271 5.39745 8.80721 5.43294 8.76343 5.43294V4.59961ZM2.75405 12.7528V13.5861H5.0162V12.7528V11.9194H2.75405V12.7528ZM5.77025 13.5068H4.93692V15.769H5.77025H6.60358V13.5068H5.77025ZM5.0162 16.523V15.6897H2.75405V16.523V17.3564H5.0162V16.523ZM2 15.769H2.83333V13.5068H2H1.16667V15.769H2ZM2.75405 16.523V15.6897C2.79784 15.6897 2.83333 15.7252 2.83333 15.769H2H1.16667C1.16667 16.6457 1.87736 17.3564 2.75405 17.3564V16.523ZM5.77025 15.769H4.93692C4.93692 15.7252 4.97241 15.6897 5.0162 15.6897V16.523V17.3564C5.89289 17.3564 6.60358 16.6457 6.60358 15.769H5.77025ZM5.0162 12.7528V13.5861C4.97241 13.5861 4.93692 13.5506 4.93692 13.5068H5.77025H6.60358C6.60358 12.6301 5.89289 11.9194 5.0162 11.9194V12.7528ZM2.75405 12.7528V11.9194C1.87736 11.9194 1.16667 12.6301 1.16667 13.5068H2H2.83333C2.83333 13.5506 2.79784 13.5861 2.75405 13.5861V12.7528ZM14.9838 12.7528V13.5861H17.2459V12.7528V11.9194H14.9838V12.7528ZM18 13.5068H17.1667V15.769H18H18.8333V13.5068H18ZM17.2459 16.523V15.6897H14.9838V16.523V17.3564H17.2459V16.523ZM14.2297 15.769H15.0631V13.5068H14.2297H13.3964V15.769H14.2297ZM14.9838 16.523V15.6897C15.0276 15.6897 15.0631 15.7252 15.0631 15.769H14.2297H13.3964C13.3964 16.6457 14.1071 17.3564 14.9838 17.3564V16.523ZM18 15.769H17.1667C17.1667 15.7252 17.2022 15.6897 17.2459 15.6897V16.523V17.3564C18.1226 17.3564 18.8333 16.6457 18.8333 15.769H18ZM17.2459 12.7528V13.5861C17.2022 13.5861 17.1667 13.5506 17.1667 13.5068H18H18.8333C18.8333 12.6301 18.1226 11.9194 17.2459 11.9194V12.7528ZM14.9838 12.7528V11.9194C14.1071 11.9194 13.3964 12.6301 13.3964 13.5068H14.2297H15.0631C15.0631 13.5506 15.0276 13.5861 14.9838 13.5861V12.7528ZM7.6053 6.12833V5.295H3.01915V6.12833V6.96166H7.6053V6.12833ZM17 6.12833V5.295H12.1915V6.12833V6.96166H17V6.12833ZM4.03829 11.7336H3.20496V12.7528H4.03829H4.87162V11.7336H4.03829ZM16.268 11.7336H15.4347V12.7528H16.268H17.1014V11.7336H16.268ZM4.03829 11.7336H4.87162C4.87162 9.77976 5.93217 8.07262 7.513 7.15815L7.09573 6.43682L6.67846 5.71548C4.60381 6.9156 3.20496 9.16076 3.20496 11.7336H4.03829ZM13.2106 6.43682L12.7933 7.15815C14.3742 8.07262 15.4347 9.77976 15.4347 11.7336H16.268H17.1014C17.1014 9.16076 15.7025 6.9156 13.6279 5.71548L13.2106 6.43682Z"
                        fill="currentColor"/>
                </symbol>

                <symbol id="icon-jupyter-settings" viewBox="0 0 20 21">
                    <path
                        d="M14.0001 10.6016H6M14.0001 10.6016C16.2093 10.6016 18.0001 8.8107 18.0001 6.60156C18.0001 4.39242 16.2093 2.60156 14.0001 2.60156H6C3.79081 2.60156 1.99993 4.3925 2 6.60169C2.00007 8.81078 3.79091 10.6016 6 10.6016M14.0001 10.6016C16.2093 10.6016 18.0001 12.3924 18.0001 14.6016C18.0001 16.8107 16.2093 18.6016 14.0001 18.6016H6C3.79091 18.6016 2.00007 16.8108 2 14.6017C1.99993 12.3925 3.79081 10.6016 6 10.6016M14.4999 6.60156H9.49987M14.4999 14.6016H9.49987M5.49987 14.6768V14.6016M5.49987 6.60156V6.52637"
                        stroke="currentColor" strokeWidth="1.66667" strokeLinecap="round" strokeLinejoin="round"
                        fill="none"/>
                </symbol>

                <symbol id="icon-jupyter-run" viewBox="0 0 20 21">
                    <path
                        d="M8 14.0996L6.5 18.0996M13.828 18.0441L12.0602 14.155M4 14.0996C2.89543 14.0996 2 13.2042 2 12.0996V5.09961C2 3.99504 2.89543 3.09961 4 3.09961H16C17.1046 3.09961 18 3.99504 18 5.09961V12.0996C18 13.2042 17.1046 14.0996 16 14.0996H4Z"
                        stroke="currentColor" strokeWidth="1.66667" strokeLinecap="round" strokeLinejoin="round"
                        fill="none"/>
                </symbol>

                <symbol id="icon-search" viewBox="0 0 20 20">
                    <path
                        d="M8.5 15C12.0899 15 15 12.0899 15 8.5C15 4.91015 12.0899 2 8.5 2C4.91015 2 2 4.91015 2 8.5C2 12.0899 4.91015 15 8.5 15Z"
                        stroke="currentColor" strokeWidth="1.5" fill="none"/>
                    <path d="M13 13L18 18" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" fill="none"/>
                </symbol>

                <symbol id="icon-settings" viewBox="0 0 20 20">
                    <path
                        d="M9.99707 1.66602C10.5496 1.66602 11.08 1.88571 11.4707 2.27637C11.8614 2.66707 12.0811 3.19747 12.0811 3.75V4.10547C12.8051 4.3605 13.4759 4.74743 14.0596 5.24609L14.3682 5.06738C14.6053 4.93059 14.8673 4.84228 15.1387 4.80664C15.4101 4.771 15.6858 4.78942 15.9502 4.86035C16.2145 4.93129 16.4626 5.05304 16.6797 5.21973C16.8968 5.38644 17.079 5.59492 17.2158 5.83203C17.3524 6.06894 17.4409 6.33043 17.4766 6.60156C17.5122 6.8729 17.4937 7.14876 17.4229 7.41309C17.3519 7.6774 17.2301 7.9255 17.0635 8.14258C16.8969 8.35958 16.6891 8.54194 16.4521 8.67871L16.1436 8.85645C16.2824 9.61169 16.2824 10.3864 16.1436 11.1416L16.4521 11.3193V11.3184C16.931 11.5946 17.2806 12.05 17.4238 12.584C17.567 13.1179 17.4921 13.6872 17.2158 14.166C16.9396 14.6446 16.4849 14.9945 15.9512 15.1377C15.4173 15.2809 14.848 15.2059 14.3691 14.9297L14.0586 14.75C13.4754 15.2496 12.805 15.6376 12.0811 15.8936V16.25C12.081 16.8024 11.8613 17.332 11.4707 17.7227C11.08 18.1134 10.5496 18.333 9.99707 18.333C9.4447 18.3329 8.915 18.1132 8.52441 17.7227C8.13383 17.332 7.91415 16.8024 7.91406 16.25V15.8936C7.18978 15.6386 6.51841 15.2517 5.93457 14.7529L5.62598 14.9316C5.14712 15.2079 4.57789 15.2829 4.04395 15.1396C3.51005 14.9964 3.05456 14.6468 2.77832 14.168C2.50206 13.6891 2.42803 13.1199 2.57129 12.5859C2.71455 12.052 3.06412 11.5966 3.54297 11.3203L3.85059 11.1426C3.71184 10.3876 3.71187 9.61343 3.85059 8.8584L3.54297 8.68066C3.06418 8.40444 2.71459 7.94888 2.57129 7.41504C2.42805 6.88116 2.50215 6.31183 2.77832 5.83301C3.05455 5.35421 3.51008 5.00462 4.04395 4.86133C4.5779 4.71807 5.14711 4.79307 5.62598 5.06934L5.93652 5.24902C6.51974 4.74945 7.19004 4.36141 7.91406 4.10547V3.75C7.91406 3.19747 8.13371 2.66707 8.52441 2.27637C8.915 1.88583 9.44475 1.66614 9.99707 1.66602ZM9.99707 7.22168C9.44782 7.22168 8.91083 7.38438 8.4541 7.68945C7.9973 7.99468 7.64091 8.42895 7.43066 8.93652C7.22053 9.44401 7.16531 10.0023 7.27246 10.541C7.3796 11.0796 7.64399 11.5745 8.03223 11.9629C8.42071 12.3514 8.91624 12.6165 9.45508 12.7236C9.99378 12.8308 10.5521 12.7756 11.0596 12.5654C11.5671 12.3552 12.0014 11.9988 12.3066 11.542C12.6117 11.0853 12.7744 10.5483 12.7744 9.99902C12.7744 9.26237 12.4818 8.55606 11.9609 8.03516C11.4401 7.51427 10.7337 7.22173 9.99707 7.22168Z"
                        fill="currentColor"/>
                </symbol>

                <symbol id="icon-help" viewBox="0 0 20 20">
                    <path
                        d="M9.99935 1.66699C5.39935 1.66699 1.66602 5.40033 1.66602 10.0003C1.66602 14.6003 5.39935 18.3337 9.99935 18.3337C14.5993 18.3337 18.3327 14.6003 18.3327 10.0003C18.3327 5.40033 14.5993 1.66699 9.99935 1.66699ZM10.8327 15.8337H9.16602V14.167H10.8327V15.8337ZM12.5577 9.37533L11.8077 10.142C11.2077 10.7503 10.8327 11.2503 10.8327 12.5003H9.16602V12.0837C9.16602 11.167 9.54102 10.3337 10.141 9.72533L11.1743 8.67533C11.4827 8.37533 11.666 7.95866 11.666 7.50033C11.666 6.58366 10.916 5.83366 9.99935 5.83366C9.08268 5.83366 8.33268 6.58366 8.33268 7.50033H6.66602C6.66602 5.65866 8.15768 4.16699 9.99935 4.16699C11.841 4.16699 13.3327 5.65866 13.3327 7.50033C13.3327 8.23366 13.0327 8.90033 12.5577 9.37533Z"
                        fill="currentColor"/>
                </symbol>

                <symbol id="icon-toggle-close" viewBox="0 0 20 20">
                    <path
                        d="M12.3251 18.5827H7.67355C5.52684 18.5827 4.07089 18.1292 3.09638 17.1523C2.11955 16.1778 1.66602 14.7242 1.66602 12.5751V7.92355C1.66602 5.77684 2.11955 4.32089 3.09638 3.34638C4.07089 2.36955 5.52451 1.91602 7.67355 1.91602H12.3251C14.4719 1.91602 15.9278 2.36955 16.9023 3.34638C17.8792 4.32089 18.3327 5.77684 18.3327 7.92355V12.5751C18.3327 14.7219 17.8792 16.1778 16.9023 17.1523C15.9278 18.1292 14.4719 18.5827 12.3251 18.5827ZM7.67355 3.07891C5.85478 3.07891 4.66164 3.42546 3.91739 4.16739C3.17546 4.91164 2.82891 6.10478 2.82891 7.92355V12.5751C2.82891 14.3939 3.17546 15.5871 3.91739 16.3313C4.66164 17.0732 5.85478 17.4198 7.67355 17.4198H12.3251C14.1439 17.4198 15.3371 17.0732 16.0813 16.3313C16.8232 15.5871 17.1698 14.3939 17.1698 12.5751V7.92355C17.1698 6.10478 16.8232 4.91164 16.0813 4.16739C15.3371 3.42546 14.1439 3.07891 12.3251 3.07891H7.67355Z"
                        fill="currentColor"/>
                    <path
                        d="M6.89906 18.6255C6.5781 18.6255 6.31761 18.365 6.31761 18.0441V2.53798C6.31761 2.21702 6.5781 1.95653 6.89906 1.95653C7.22002 1.95653 7.48051 2.21702 7.48051 2.53798V18.0441C7.48051 18.365 7.22002 18.6255 6.89906 18.6255Z"
                        fill="currentColor"/>
                    <path
                        d="M12.3251 12.5632C12.1763 12.5632 12.0274 12.5074 11.9135 12.3934L9.92957 10.4098C9.70165 10.1819 9.70165 9.81448 9.92957 9.58659L11.9135 7.60296C12.1414 7.37506 12.5089 7.37506 12.7368 7.60296C12.9647 7.83086 12.9647 8.19828 12.7368 8.42618L11.1646 9.9982L12.7368 11.5702C12.9647 11.7981 12.9647 12.1655 12.7368 12.3934C12.5089 12.6213 12.474 12.5632 12.3251 12.5632Z"
                        fill="currentColor"/>
                </symbol>

                <symbol id="icon-toggle-open" viewBox="0 0 20 20">
                    <path
                        d="M7.67485 18.5827H12.3264C14.4732 18.5827 15.9291 18.1292 16.9036 17.1523C17.8805 16.1778 18.334 14.7242 18.334 12.5751V7.92355C18.334 5.77684 17.8805 4.32089 16.9036 3.34638C15.9291 2.36955 14.4755 1.91602 12.3264 1.91602H7.67485C5.52814 1.91602 4.07219 2.36955 3.09768 3.34638C2.12085 4.32089 1.66732 5.77684 1.66732 7.92355V12.5751C1.66732 14.7219 2.12085 16.1778 3.09768 17.1523C4.07219 18.1292 5.52814 18.5827 7.67485 18.5827ZM12.3264 3.07891C14.1452 3.07891 15.3384 3.42546 16.0826 4.16739C16.8245 4.91164 17.1711 6.10478 17.1711 7.92355V12.5751C17.1711 14.3939 16.8245 15.5871 16.0826 16.3313C15.3384 17.0732 14.1452 17.4198 12.3264 17.4198H7.67485C5.85608 17.4198 4.66295 17.0732 3.91869 16.3313C3.17676 15.5871 2.83022 14.3939 2.83022 12.5751V7.92355C2.83022 6.10478 3.17676 4.91164 3.91869 4.16739C4.66295 3.42546 5.85608 3.07891 7.67485 3.07891H12.3264Z"
                        fill="currentColor"/>
                    <path
                        d="M13.1009 18.6255C13.4219 18.6255 13.6824 18.365 13.6824 18.0441V2.53798C13.6824 2.21702 13.4219 1.95653 13.1009 1.95653C12.78 1.95653 12.5195 2.21702 12.5195 2.53798V18.0441C12.5195 18.365 12.78 18.6255 13.1009 18.6255Z"
                        fill="currentColor"/>
                    <path
                        d="M7.67485 12.5632C7.8237 12.5632 7.97255 12.5074 8.08652 12.3934L10.0704 10.4098C10.2984 10.1819 10.2984 9.81448 10.0704 9.58659L8.08652 7.60296C7.85859 7.37506 7.49111 7.37506 7.26319 7.60296C7.03526 7.83086 7.03526 8.19828 7.26319 8.42618L8.83543 9.9982L7.26319 11.5702C7.03526 11.7981 7.03526 12.1655 7.26319 12.3934C7.49111 12.6213 7.526 12.5632 7.67485 12.5632Z"
                        fill="currentColor"/>
                </symbol>
            </svg>
        </>
    )
}

export default SideBar;